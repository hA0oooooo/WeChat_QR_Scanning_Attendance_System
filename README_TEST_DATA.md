# 测试数据说明文档

## 概述

本系统采用模块化的测试数据管理方式：
- **`tests/`文件夹**：负责具体的测试数据初始化逻辑
- **`init_test_data.py`**：作为主入口，调用tests模块中的函数

这种设计使得测试数据的创建逻辑更加清晰，便于维护和扩展。

## 快速开始

### 初始化测试数据

```bash
# 在项目根目录运行
python init_test_data.py

# 初始化完成后，启动Django服务器
python manage.py runserver

# 在浏览器中访问
http://127.0.0.1:8000/
```

**特性说明：**
- 每次运行都会完全清除所有现有数据（包括用户账号）
- 所有账号密码统一设置为 `1`，便于测试
- 一键重置整个测试环境，确保数据一致性

## 登录账号

初始化完成后，可以使用以下账号登录系统：

| 角色 | 用户名 | 密码 | 说明 |
|------|--------|------|------|
| 管理员 | `admin` | `1` | 系统管理员，可管理所有数据 |
| 教师 | `12345` | `1` | 郑老师，工号12345 |
| 学生 | `23307130001` | `1` | 开心，学号23307130001 |

**注意**：系统中共有10个学生数据，但只有"开心"拥有登录账号，其余9个学生（勇敢、自信、坚强、美丽、智慧、努力、温暖、光明、希望）仅作为数据存在，用于统计展示。

## 系统架构

### 组织架构
- **大数据学院**
  - 数据科学与大数据技术专业
- **数学科学学院**
  - 应用数学专业

### 课程信息

#### 数据库及实现课程
- **课程代码**：DATA130039.01
- **课程名称**：数据库及实现
- **开课院系**：大数据学院
- **上课时间**：星期三第3-5节（9:55-12:30）
- **上课地点**：HGX508
- **选课学生**：10人（包括开心）
- **扫码有效时间**：9:55-12:30

#### 最优化方法课程
- **课程代码**：DATA130026.01
- **课程名称**：最优化方法
- **开课院系**：数学科学学院
- **上课时间**：星期四第6-8节（13:30-16:10）
- **上课地点**：H3209
- **选课学生**：5人（不包括开心）
- **扫码有效时间**：13:30-16:10

## 人员信息

### 教师
- **姓名**：郑老师
- **工号**：12345
- **所属院系**：大数据学院
- **登录账号**：12345 / 1
- **授课课程**：数据库及实现、最优化方法

### 学生信息

#### 有登录账号的学生
- **姓名**：开心
- **学号**：23307130001
- **性别**：男
- **专业**：数据科学与大数据技术
- **登录账号**：23307130001 / 1
- **选修课程**：数据库及实现（不选修最优化方法）
- **微信OpenID**：wx_openid_23307130001

#### 数据学生（无登录账号）
系统中还包含9个学生数据，用于丰富统计展示：

| 学号 | 姓名 | 性别 | 专业 | 数据库课程 | 最优化方法 |
|------|------|------|------|------------|------------|
| 23307130002 | 勇敢 | 女 | 数据科学与大数据技术 | ✓ | ✓ |
| 23307130003 | 自信 | 男 | 数据科学与大数据技术 | ✓ | ✓ |
| 23307130004 | 坚强 | 女 | 数据科学与大数据技术 | ✓ | ✓ |
| 23307130005 | 美丽 | 男 | 数据科学与大数据技术 | ✓ | ✓ |
| 23307130006 | 智慧 | 女 | 数据科学与大数据技术 | ✓ | ✓ |
| 23307130007 | 努力 | 男 | 数据科学与大数据技术 | ✓ | - |
| 23307130008 | 温暖 | 女 | 数据科学与大数据技术 | ✓ | - |
| 23307130009 | 光明 | 男 | 数据科学与大数据技术 | ✓ | - |
| 23307130010 | 希望 | 女 | 数据科学与大数据技术 | ✓ | - |

## 考勤数据设计

### 数据库及实现课程考勤

| 日期 | 描述 | 扫码时间 | 状态 | 开心状态 | 整体情况 |
|------|------|----------|------|----------|----------|
| 2025-06-11 | 第一次课 | 9:55-12:30 | 已完成 | 出勤 | 8人出勤，2人缺勤 |
| 2025-06-18 | 第二次课 | 9:55-12:30 | 进行中 | 缺勤 | 4人出勤，4人缺勤，2人请假 |
| 2025-06-25 | 第三次课 | 9:55-12:30 | 未开始 | 未开始 | 可申请请假 |

**统计数据**：
- 总考勤人次：20人次（10人×2次）
- 总考勤次数：2次
- 整体出勤率：60%

### 最优化方法课程考勤

| 日期 | 描述 | 扫码时间 | 状态 | 整体情况 |
|------|------|----------|------|----------|
| 2025-06-12 | 第一次课 | 13:30-16:10 | 已完成 | 4人出勤，1人缺勤 |
| 2025-06-19 | 第二次课 | 13:30-16:10 | 已完成 | 3人出勤，1人缺勤，1人请假 |
| 2025-06-26 | 第三次课 | 13:30-16:10 | 未开始 | 可申请请假 |

**统计数据**：
- 总考勤人次：10人次（5人×2次）
- 总考勤次数：2次
- 整体出勤率：70%

### 请假管理
- **初始状态**：无请假申请（便于演示申请流程）
- **可演示功能**：
  - 学生申请6月25日数据库课程请假
  - 教师审批请假申请
  - 请假记录动态显示

## 演示场景

### 当前模拟时间
**2025年6月18日 11:00**（数据库课程进行中）

### 统计报表展示
访问管理员统计报表页面可以看到：
- **两门课程对比**：数据库课程与最优化方法的出勤率对比
- **总考勤人次和总考勤次数**：以黑色徽章显示
- **查看单次考勤**：深蓝色按钮，可展开每次课的详细统计
- **甜甜圈图表**：每次课程都有独立的出勤情况可视化

### 演示流程建议

1. **管理员登录**（admin/1）
   - 查看统计报表，对比两门课程出勤情况
   - 管理用户和课程信息
   - 查看选课管理（可添加/删除学生）

2. **教师登录**（12345/1）
   - 查看课程和学生信息
   - 管理考勤事件
   - 审批请假申请
   - 查看教学安排

3. **学生登录**（23307130001/1）
   - 查看个人课程和考勤记录（只能看到数据库课程）
   - 扫码签到（模拟6月18日签到）
   - 申请请假（为6月25日课程申请）

### 出勤率计算示例

#### 开心（学生视角）
- **总课程数**：2次（排除未开始的6月25日）
- **出勤次数**：1次（6月11日出勤）
- **出勤率**：50%
- **演示后**：扫码签到后出勤率变为100%

#### 数据库课程（整体统计）
- **总考勤人次**：20人次
- **出勤人次**：12人次
- **出勤率**：60%

#### 最优化方法（整体统计）
- **总考勤人次**：10人次
- **出勤人次**：7人次
- **出勤率**：70%

## 技术实现

### tests文件夹结构
```
tests/
├── __init__.py                      # Python包初始化文件
└── test_data_initialization.py      # 测试数据创建模块
```

### 模块化设计

#### `tests/test_data_initialization.py`
负责具体的数据创建逻辑，包含以下函数：

- `reset_database()` - 重置数据库，清理所有旧数据
- `create_basic_data()` - 创建基础数据（两个部门、两个专业、两门课程）
- `create_users_and_roles()` - 创建用户账号和角色（管理员、教师、10个学生）
- `create_teaching_assignments()` - 创建数据库课程的教学安排
- `create_teaching_assignments_optimization()` - 创建最优化方法的教学安排
- `create_course_data()` - 创建数据库课程的选课和考勤数据
- `create_course_data_optimization()` - 创建最优化方法的选课和考勤数据
- `clear_leave_requests()` - 清空请假申请，准备演示环境
- `create_test_data()` - 主函数，协调所有数据创建流程

#### `init_test_data.py`
作为主入口文件，职责：
- 设置项目路径和Django环境
- 调用tests模块中的函数
- 提供友好的用户界面和进度提示
- 显示初始化结果和使用说明

### 数据清理策略

`init_test_data.py` 脚本采用彻底清理策略：
1. 按依赖关系顺序删除，避免外键约束错误
2. 清除所有用户（包括超级用户），确保环境干净
3. 重新创建完整的测试数据集
4. 提供详细的创建进度提示

### 密码设置
- **统一密码**：所有账号密码都是 `1`
- **安全性**：仅用于开发和测试环境
- **便利性**：简化测试流程，便于快速验证功能

## 数据特色设计

### 学生姓名设计
所有学生姓名都采用积极正面的二字词汇：开心、勇敢、自信、坚强、美丽、智慧、努力、温暖、光明、希望，体现了系统的人性化设计。

### 课程时间安排
- **数据库及实现**：星期三上午（第3-5节），适合理论与实践结合
- **最优化方法**：星期四下午（第6-8节），适合数学建模和算法学习

### 考勤数据的真实性
考勤数据设计考虑了实际教学场景：
- 不同课程有不同的出勤率表现
- 包含出勤、缺勤、请假等多种状态
- 时间安排符合大学课程表惯例

## 扩展说明

### 添加更多学生
如需要更多学生账号进行测试，可以修改 `tests/test_data_initialization.py` 中的 `create_users_and_roles()` 函数，在学生创建部分添加更多学生数据。

### 自定义考勤场景
可以修改 `create_course_data()` 和 `create_course_data_optimization()` 函数中的考勤数据设置，调整不同的出勤模式。

### 批量数据处理
tests模块的设计支持批量数据处理，可以根据需要扩展为创建大量测试数据的场景。

### 多课程演示
当前设计支持多课程对比展示，可以很好地演示系统的统计分析功能和跨课程数据管理能力。



 